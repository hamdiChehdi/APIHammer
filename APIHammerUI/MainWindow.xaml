<Window x:Class="APIHammerUI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialIcons="clr-namespace:Material.Icons.WPF;assembly=Material.Icons.WPF"
        Title="API Hammer - API Testing Tool" Height="700" Width="1400"
        WindowStartupLocation="CenterScreen"
        Background="#1E1E1E">

    <Grid Background="{StaticResource DarkBackground}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="280"/>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Toolbar -->
        <Border Grid.Row="0" Grid.ColumnSpan="3" Background="{StaticResource DarkPanel}" BorderBrush="{StaticResource DarkBorder}" BorderThickness="0,0,0,1">
            <StackPanel Orientation="Horizontal" Margin="16,12">
                <TextBlock Text="Collections:" VerticalAlignment="Center" FontSize="12" FontWeight="Medium" Foreground="{StaticResource TextSecondary}" Margin="0,0,8,0"/>
                <Button Content="New Collection" Command="{Binding CreateNewCollectionCommand}" Style="{StaticResource ModernButtonStyle}" Margin="0,0,8,0" Padding="12,6" FontSize="12"/>
                <Rectangle Width="1" Fill="{StaticResource DarkBorder}" Margin="8,4,16,4"/>
                <TextBlock Text="Quick Add:" VerticalAlignment="Center" FontSize="12" FontWeight="Medium" Foreground="{StaticResource TextSecondary}" Margin="0,0,8,0"/>
                <Button Content="+ HTTP" Command="{Binding NewHttpTabCommand}" Style="{StaticResource ModernButtonStyle}" Background="{StaticResource SuccessGreen}" Margin="0,0,6,0" Padding="10,6" FontSize="11"/>
                <Button Content="+ WebSocket" Command="{Binding NewWebSocketTabCommand}" Style="{StaticResource ModernButtonStyle}" Background="{StaticResource WarningOrange}" Margin="0,0,6,0" Padding="10,6" FontSize="11"/>
                <Button Content="+ gRPC" Command="{Binding NewGrpcTabCommand}" Style="{StaticResource ModernButtonStyle}" Background="{StaticResource AccentBlue}" Margin="0,0,16,0" Padding="10,6" FontSize="11"/>
                <Rectangle Width="1" Fill="{StaticResource DarkBorder}" Margin="0,4"/>
                <Button Content="Export Profile" Command="{Binding ExportDatabaseCommand}" Style="{StaticResource SecondaryButtonStyle}" FontSize="11" Padding="10,6" Margin="12,0,6,0"/>
                <Button Content="Import Profile" Command="{Binding ImportDatabaseCommand}" Style="{StaticResource SecondaryButtonStyle}" FontSize="11" Padding="10,6" Margin="0,0,6,0"/>
                <TextBlock Text="Tip: Right-click items to rename or delete" VerticalAlignment="Center" Margin="16,0,0,0" FontSize="11" Foreground="{StaticResource TextMuted}"/>
            </StackPanel>
        </Border>

        <!-- Left Panel -->
        <Border Grid.Row="1" Grid.Column="0" Background="{StaticResource DarkPanel}" BorderBrush="{StaticResource DarkBorder}" BorderThickness="0,0,1,0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Header -->
                <Border Grid.Row="0" Background="{StaticResource DarkCard}" BorderBrush="{StaticResource DarkBorder}" BorderThickness="0,0,0,1" Padding="16,12">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="COLLECTIONS" FontWeight="Bold" FontSize="11" VerticalAlignment="Center" Foreground="{StaticResource TextMuted}"/>
                        <Button Grid.Column="1" Content="+" Command="{Binding CreateNewCollectionCommand}" ToolTip="Create New Collection" Style="{StaticResource ModernButtonStyle}" Width="24" Height="24" Padding="0" FontSize="14" FontWeight="Bold"/>
                    </Grid>
                </Border>

                <!-- Collection Toolbar -->
                <Border Grid.Row="1" Background="{StaticResource DarkPanel}" BorderBrush="{StaticResource DarkBorder}" BorderThickness="0,0,0,1" Padding="12,8">
                    <WrapPanel>
                        <Button Content="+ New Collection" Command="{Binding CreateNewCollectionCommand}" Style="{StaticResource ModernButtonStyle}" FontSize="11" Padding="8,4" Margin="0,0,4,4"/>
                        <Button Content="Rename" Command="{Binding RenameCollectionCommand}" Style="{StaticResource SecondaryButtonStyle}" FontSize="11" Padding="8,4" Margin="0,0,4,4"/>
                        <Button Content="Delete" Command="{Binding DeleteCollectionCommand}" Style="{StaticResource SecondaryButtonStyle}" FontSize="11" Padding="8,4" Margin="0,0,0,4"/>
                    </WrapPanel>
                </Border>

                <!-- TreeView -->
                <Grid Grid.Row="2">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <TreeView Grid.Row="0" x:Name="TabExplorerTreeView" ItemsSource="{Binding TabCollections}" SelectedItemChanged="TreeView_SelectedItemChanged" Margin="8" Background="Transparent" BorderThickness="0">
                        <TreeView.ItemTemplate>
                            <HierarchicalDataTemplate ItemsSource="{Binding Tabs}">
                                <StackPanel Orientation="Horizontal">
                                    <StackPanel.ContextMenu>
                                        <ContextMenu>
                                            <MenuItem Header="Send All Requests" Click="CollectionMenu_SendAllRequests"/>
                                            <Separator />
                                            <MenuItem Header="Rename Collection" Click="CollectionMenu_Rename"/>
                                            <MenuItem Header="Export Collection..." Click="CollectionMenu_Export"/>
                                            <Separator />
                                            <MenuItem Header="Delete Collection" Click="CollectionMenu_Delete"/>
                                        </ContextMenu>
                                    </StackPanel.ContextMenu>
                                    <materialIcons:MaterialIcon Kind="Group" Margin="0,0,6,0" Foreground="{StaticResource AccentBlue}"/>
                                    <TextBlock Text="{Binding Name}" Foreground="{StaticResource TextPrimary}" FontWeight="Medium" FontSize="13"/>
                                    <TextBlock Text="{Binding Tabs.Count, StringFormat='({0})'}" Foreground="{StaticResource TextMuted}" FontSize="11" Margin="6,0,0,0"/>
                                </StackPanel>
                                <HierarchicalDataTemplate.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" Margin="0,2">
                                            <StackPanel.ContextMenu>
                                                <ContextMenu>
                                                    <MenuItem Header="Rename" Click="TabMenu_Rename"/>
                                                    <MenuItem Header="Move to Collection..." Click="TabMenu_Move"/>
                                                    <Separator />
                                                    <MenuItem Header="Close" Click="TabMenu_Close"/>
                                                </ContextMenu>
                                            </StackPanel.ContextMenu>
                                            <Border Background="{Binding RequestType, Converter={StaticResource RequestTypeColorConverter}}" CornerRadius="3" Padding="6,2" Margin="0,0,8,0">
                                                <TextBlock Text="{Binding RequestType, Converter={StaticResource RequestTypeIconConverter}}" Foreground="White" FontSize="8" FontWeight="Bold"/>
                                            </Border>
                                            <TextBlock Text="{Binding Name}" Foreground="{StaticResource TextPrimary}" FontSize="12" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </HierarchicalDataTemplate.ItemTemplate>
                            </HierarchicalDataTemplate>
                        </TreeView.ItemTemplate>
                    </TreeView>

                    <!-- Quick Add Section -->
                    <Border Grid.Row="1" Background="{StaticResource DarkCard}" BorderBrush="{StaticResource DarkBorder}" BorderThickness="0,1,0,0" Padding="12,8" VerticalAlignment="Bottom">
                        <StackPanel>
                            <TextBlock Text="QUICK ADD" FontWeight="Bold" FontSize="10" Foreground="{StaticResource TextMuted}" Margin="0,0,0,8"/>
                            <StackPanel Orientation="Horizontal">
                                <Button Content="HTTP" Command="{Binding NewHttpTabCommand}" Style="{StaticResource ModernButtonStyle}" Background="{StaticResource SuccessGreen}" Padding="6,3" FontSize="10" Margin="0,0,4,0"/>
                                <Button Content="WS" Command="{Binding NewWebSocketTabCommand}" Style="{StaticResource ModernButtonStyle}" Background="{StaticResource WarningOrange}" Padding="6,3" FontSize="10" Margin="0,0,4,0"/>
                                <Button Content="gRPC" Command="{Binding NewGrpcTabCommand}" Style="{StaticResource ModernButtonStyle}" Background="{StaticResource AccentBlue}" Padding="6,3" FontSize="10"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </Grid>
            </Grid>
        </Border>

        <!-- Splitter -->
        <GridSplitter Grid.Row="1" Grid.Column="1" Width="1" Background="{StaticResource DarkBorder}" HorizontalAlignment="Stretch" ResizeBehavior="PreviousAndNext"/>

        <!-- Main Content -->
        <Grid Grid.Row="1" Grid.Column="2" Background="{StaticResource DarkCard}">
            <ContentPresenter Content="{Binding SelectedTab.Content}"/>
            <Border Background="{StaticResource DarkCard}">
                <Border.Style>
                    <Style TargetType="Border">
                        <Setter Property="Visibility" Value="Collapsed"/>
                        <Setter Property="Background" Value="{StaticResource DarkCard}"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding SelectedTab}" Value="{x:Null}">
                                <Setter Property="Visibility" Value="Visible"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Border.Style>
                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" MaxWidth="500">
                    <Border Width="80" Height="80" Background="{StaticResource AccentBlue}" CornerRadius="40" Margin="0,0,0,24">
                        <TextBlock Text="API" FontSize="18" FontWeight="Bold" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="White"/>
                    </Border>
                    <TextBlock Text="Welcome to API Hammer" FontSize="28" FontWeight="Light" HorizontalAlignment="Center" Foreground="{StaticResource TextPrimary}" Margin="0,0,0,16"/>
                    <TextBlock Text="A powerful API testing tool for modern developers" FontSize="16" HorizontalAlignment="Center" Foreground="{StaticResource TextSecondary}" TextAlignment="Center" Margin="0,0,0,24"/>
                    <TextBlock Text="Get started by creating a collection and adding requests" FontSize="14" HorizontalAlignment="Center" Foreground="{StaticResource TextMuted}" TextAlignment="Center" Margin="0,0,0,32"/>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                        <Button Content="Create Collection" Command="{Binding CreateNewCollectionCommand}" Style="{StaticResource ModernButtonStyle}" Margin="0,0,12,0" Padding="16,8"/>
                        <Button Content="+ HTTP Request" Command="{Binding NewHttpTabCommand}" Style="{StaticResource SecondaryButtonStyle}" Margin="0,0,8,0" Padding="16,8"/>
                        <Button Content="+ WebSocket" Command="{Binding NewWebSocketTabCommand}" Style="{StaticResource SecondaryButtonStyle}" Margin="0,0,8,0" Padding="16,8"/>
                        <Button Content="+ gRPC" Command="{Binding NewGrpcTabCommand}" Style="{StaticResource SecondaryButtonStyle}" Padding="16,8"/>
                    </StackPanel>
                </StackPanel>
            </Border>
        </Grid>
    </Grid>
</Window>
